Castling is not done. Needs to debug.